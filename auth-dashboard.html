<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Auth & Dashboard</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
    }

    body {
      background: #f8f9fa;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    .auth-container,
    .dashboard {
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
      width: 100%;
      max-width: 450px;
    }

    .tab-header {
      display: flex;
      margin-bottom: 20px;
      border-bottom: 1px solid #eee;
    }

    .tab-btn {
      padding: 12px 20px;
      font-size: 18px;
      background: none;
      border: none;
      cursor: pointer;
      color: #555;
      position: relative;
      font-weight: 500;
    }

    .tab-btn.active {
      color: #4169E1;
    }

    .tab-btn.active::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      width: 100%;
      height: 3px;
      background: #4169E1;
    }

    h2 {
      margin-bottom: 20px;
      font-weight: 500;
    }

    .input-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      color: #555;
    }

    input {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 16px;
      transition: border-color 0.2s;
    }

    input:focus {
      outline: none;
      border-color: #4169E1;
    }


    .checkbox-container {
      display: flex;
      align-items: center;
      margin-bottom: 0;
    }

    .checkbox-container input[type="checkbox"] {
      width: 16px;
      height: 16px;
      margin-right: 8px;
      cursor: pointer;
      appearance: auto;
      -webkit-appearance: auto;
    }

    .checkbox-container label {
      display: inline;
      margin-bottom: 0;
      cursor: pointer;
      user-select: none;
    }

    .checkbox-container input {
      width: auto;
      margin-right: 8px;
    }

    .forgot-password {
      text-align: right;
      margin-bottom: 20px;
      color: #405FF2;
    }

    .forgot-password a {
      color: #4169E1;
      text-decoration: none;
    }

    .btn {
      width: 100%;
      padding: 14px;
      background: #4169E1;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
    }

    .btn .icon {
      margin-left: 8px;
    }

    .btn:hover {
      background: #3251b8;
    }

    .divider {
      display: flex;
      align-items: center;
      margin: 25px 0;
      color: #777;
    }

    .divider::before,
    .divider::after {
      content: '';
      flex: 1;
      height: 1px;
      background: #ddd;
    }

    .divider span {
      padding: 0 15px;
    }

    .social-buttons {
      display: flex;
      justify-content: space-between;
      gap: 15px;
      margin-bottom: 25px;
    }

    .social-btn {
      flex: 1;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      background: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      color: #333;
      text-decoration: none;
    }

    .social-btn svg {
      margin-right: 8px;
      width: 20px;
      height: 20px;
    }

    .facebook {
      color: #1877F2;
      border-color: #1877F2;
    }

    .google {
      color: #EA4335;
      border-color: #EA4335;
    }

    .demo-info {
      margin-top: 25px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 6px;
    }

    .demo-info p {
      margin: 5px 0;
      font-size: 14px;
      color: #444;
    }

    .demo-info strong {
      font-weight: 600;
    }

    .switch {
      margin-top: 15px;
      text-align: center;
    }

    .switch a {
      color: #4169E1;
      text-decoration: none;
      cursor: pointer;
    }

    .switch a:hover {
      text-decoration: underline;
    }

    .hidden {
      display: none;
    }

    /* Dashboard specific styles */
    .dashboard h2 {
      display: flex;
      align-items: center;
    }

    .dashboard h2 span {
      margin-left: 10px;
    }
  </style>
</head>

<body>

  <!-- Login -->
  <div class="auth-container" id="login-box">
    <div class="tab-header">
      <button class="tab-btn active" id="signin-tab">Sign in</button>
      <button class="tab-btn" id="register-tab">Register</button>
    </div>

    <form id="login-form">
      <div class="input-group">
        <label>Username Or Email</label>
        <input type="email" id="login-email" placeholder="ali..." required />
      </div>
      <div class="input-group">
        <label>Password</label>
        <input type="password" id="login-password" placeholder="***" required />
      </div>

      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <div class="checkbox-container">
          <input type="checkbox" id="remember-me">
          <label for="remember-me">Keep me signed in</label>
        </div>
        <div>
          <a href="#" class="forgot-password">Lost Your Password?</a>
        </div>
      </div>

      <button type="submit" class="btn">
        Login
        <svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
          stroke-linecap="round" stroke-linejoin="round">
          <path d="M5 12h14"></path>
          <path d="M12 5l7 7-7 7"></path>
        </svg>
      </button>

      <div class="divider">
        <span>OR</span>
      </div>

      <div class="social-buttons">
        <a href="#" class="social-btn facebook">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <path fill="currentColor"
              d="M12.001 2C6.47813 2 2.00098 6.47715 2.00098 12C2.00098 16.9913 5.65783 21.1283 10.4385 21.8785V14.8906H7.89941V12H10.4385V9.79688C10.4385 7.29063 11.9314 5.90625 14.2152 5.90625C15.3084 5.90625 16.4531 6.10156 16.4531 6.10156V8.5625H15.1922C13.9498 8.5625 13.5635 9.33334 13.5635 10.1242V12H16.3369L15.8936 14.8906H13.5635V21.8785C18.3441 21.1283 22.001 16.9913 22.001 12C22.001 6.47715 17.5238 2 12.001 2Z">
            </path>
          </svg>
          Login with Facebook
        </a>
        <a href="#" class="social-btn google">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <path fill="currentColor"
              d="M12.0003 4.75C13.7703 4.75 15.3553 5.36 16.6053 6.47L19.5303 3.5C17.5503 1.74 14.9603 0.75 12.0003 0.75C7.31031 0.75 3.25531 3.33 1.28531 7.04L4.66031 9.77C5.66531 6.82 8.59531 4.75 12.0003 4.75Z">
            </path>
            <path fill="currentColor"
              d="M23.49 12.27C23.49 11.48 23.42 10.73 23.3 10H12V14.51H18.47C18.18 15.99 17.33 17.25 16.07 18.1L19.28 20.78C21.4 18.79 22.99 15.8 22.99 12.27H23.49Z">
            </path>
            <path fill="currentColor"
              d="M5 12C5 11.23 5.15 10.5 5.41 9.84L2.03 7.11C1.09 8.55 0.5 10.2 0.5 12C0.5 13.8 1.08 15.44 2 16.88L5.36 14.13C5.13 13.44 5 12.73 5 12Z">
            </path>
            <path fill="currentColor"
              d="M12.0003 23.25C14.9503 23.25 17.5003 22.31 19.2803 20.78L16.0703 18.1C15.0603 18.79 13.7603 19.25 12.0003 19.25C8.59531 19.25 5.67031 17.18 4.66531 14.23L1.29031 16.96C3.25031 20.67 7.31031 23.25 12.0003 23.25Z">
            </path>
          </svg>
          Login with Google
        </a>
      </div>

      <div class="demo-info">
        <p><strong>Username:</strong> demo</p>
        <p><strong>Password:</strong> demo</p>
      </div>
    </form>
  </div>

  <!-- Register -->
  <div class="auth-container hidden" id="register-box">
    <div class="tab-header">
      <button class="tab-btn" id="signin-tab-reg">Sign in</button>
      <button class="tab-btn active" id="register-tab-reg">Register</button>
    </div>

    <form id="register-form">
      <div class="input-group">
        <label>Username Or Email</label>
        <input type="email" id="register-email" placeholder="ali..." required />
      </div>
      <div class="input-group">
        <label>Password</label>
        <input type="password" id="register-password" placeholder="***" required />
      </div>

      <button type="submit" class="btn">
        Register
        <svg class="icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
          stroke-linecap="round" stroke-linejoin="round">
          <path d="M5 12h14"></path>
          <path d="M12 5l7 7-7 7"></path>
        </svg>
      </button>

      <div class="divider">
        <span>OR</span>
      </div>

      <div class="social-buttons">
        <a href="#" class="social-btn facebook">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <path fill="currentColor"
              d="M12.001 2C6.47813 2 2.00098 6.47715 2.00098 12C2.00098 16.9913 5.65783 21.1283 10.4385 21.8785V14.8906H7.89941V12H10.4385V9.79688C10.4385 7.29063 11.9314 5.90625 14.2152 5.90625C15.3084 5.90625 16.4531 6.10156 16.4531 6.10156V8.5625H15.1922C13.9498 8.5625 13.5635 9.33334 13.5635 10.1242V12H16.3369L15.8936 14.8906H13.5635V21.8785C18.3441 21.1283 22.001 16.9913 22.001 12C22.001 6.47715 17.5238 2 12.001 2Z">
            </path>
          </svg>
          Login with Facebook
        </a>
        <a href="#" class="social-btn google">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <path fill="currentColor"
              d="M12.0003 4.75C13.7703 4.75 15.3553 5.36 16.6053 6.47L19.5303 3.5C17.5503 1.74 14.9603 0.75 12.0003 0.75C7.31031 0.75 3.25531 3.33 1.28531 7.04L4.66031 9.77C5.66531 6.82 8.59531 4.75 12.0003 4.75Z">
            </path>
            <path fill="currentColor"
              d="M23.49 12.27C23.49 11.48 23.42 10.73 23.3 10H12V14.51H18.47C18.18 15.99 17.33 17.25 16.07 18.1L19.28 20.78C21.4 18.79 22.99 15.8 22.99 12.27H23.49Z">
            </path>
            <path fill="currentColor"
              d="M5 12C5 11.23 5.15 10.5 5.41 9.84L2.03 7.11C1.09 8.55 0.5 10.2 0.5 12C0.5 13.8 1.08 15.44 2 16.88L5.36 14.13C5.13 13.44 5 12.73 5 12Z">
            </path>
            <path fill="currentColor"
              d="M12.0003 23.25C14.9503 23.25 17.5003 22.31 19.2803 20.78L16.0703 18.1C15.0603 18.79 13.7603 19.25 12.0003 19.25C8.59531 19.25 5.67031 17.18 4.66531 14.23L1.29031 16.96C3.25031 20.67 7.31031 23.25 12.0003 23.25Z">
            </path>
          </svg>
          Login with Google
        </a>
      </div>
    </form>
  </div>

  <!-- Dashboard -->
  <div class="dashboard hidden" id="dashboard-box">
    <h2>Welcome to Dashboard <span>🎉</span></h2>
    <p>You are successfully logged in.</p>
    <button class="btn" id="show-users-btn" style="margin-top: 20px;">Фойдаланувчиларни кўрсатиш</button>
    <div id="users-list" style="margin-top: 20px;"></div>
    <button class="btn" style="margin-top: 20px; background: #f44336;" onclick="logout()">Logout</button>
  </div>

  <script>
    const loginBox = document.getElementById('login-box');
    const registerBox = document.getElementById('register-box');
    const dashboardBox = document.getElementById('dashboard-box');

    const signinTab = document.getElementById('signin-tab');
    const registerTab = document.getElementById('register-tab');
    const signinTabReg = document.getElementById('signin-tab-reg');
    const registerTabReg = document.getElementById('register-tab-reg');

    const loginForm = document.getElementById('login-form');
    const registerForm = document.getElementById('register-form');
    const showUsersBtn = document.getElementById('show-users-btn');
    const usersList = document.getElementById('users-list');

    // API базовый URL
    const API_BASE_URL = 'http://localhost:5000';

    signinTab.onclick = () => {
      loginBox.classList.remove('hidden');
      registerBox.classList.add('hidden');
      signinTab.classList.add('active');
      registerTab.classList.remove('active');
    };

    registerTab.onclick = () => {
      loginBox.classList.add('hidden');
      registerBox.classList.remove('hidden');
      signinTab.classList.remove('active');
      registerTab.classList.add('active');
    };

    signinTabReg.onclick = () => {
      loginBox.classList.remove('hidden');
      registerBox.classList.add('hidden');
      signinTabReg.classList.add('active');
      registerTabReg.classList.remove('active');
    };

    registerTabReg.onclick = () => {
      loginBox.classList.add('hidden');
      registerBox.classList.remove('hidden');
      signinTabReg.classList.remove('active');
      registerTabReg.classList.add('active');
    };

    loginForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const email = document.getElementById('login-email').value.trim();
      const password = document.getElementById('login-password').value.trim();

      // For demo purposes
      if (email === 'demo' && password === 'demo') {
        loginBox.classList.add('hidden');
        dashboardBox.classList.remove('hidden');
        return;
      }

      try {
        const res = await fetch(`${API_BASE_URL}/api/auth`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, password }),
        });

        const data = await res.json();
        if (data.success) {
          loginBox.classList.add('hidden');
          dashboardBox.classList.remove('hidden');
        } else {
          alert(data.message || 'Login failed');
        }
      } catch (err) {
        alert("Server error: " + err.message);
        console.error("Login error:", err);
      }
    });

    registerForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const email = document.getElementById('register-email').value.trim();
      const password = document.getElementById('register-password').value.trim();

      try {
        const res = await fetch(`${API_BASE_URL}/api/register`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, password }),
        });

        const data = await res.json();
        if (data.success) {
          alert("Registration successful! You can now login.");
          registerBox.classList.add('hidden');
          loginBox.classList.remove('hidden');
          signinTab.classList.add('active');
          registerTab.classList.remove('active');
        } else {
          alert(data.message || 'Registration failed');
        }
      } catch (err) {
        alert("Server error: " + err.message);
        console.error("Registration error:", err);
      }
    });

    showUsersBtn.addEventListener('click', async () => {
      try {
        const res = await fetch(`${API_BASE_URL}/api/users`);
        const users = await res.json();

        usersList.innerHTML = '<h3>Рўйхатдан ўтган фойдаланувчилар:</h3>';
        if (users.length === 0) {
          usersList.innerHTML += '<p>Ҳозирча фойдаланувчилар йўқ</p>';
        } else {
          const ul = document.createElement('ul');
          users.forEach(user => {
            const li = document.createElement('li');
            li.textContent = `${user.email}`;
            ul.appendChild(li);
          });
          usersList.appendChild(ul);
        }
      } catch (err) {
        alert("Фойдаланувчилар рўйхатини олишда хатолик юз берди: " + err.message);
        console.error("Users list error:", err);
      }
    });

    function logout() {
      dashboardBox.classList.add('hidden');
      loginBox.classList.remove('hidden');
      loginForm.reset();
      usersList.innerHTML = '';
    }
  </script>

</body>

</html>